function formatMarkdownOutput() {
  // Add some Bootstrap CSS classes to elements generated from Markdown (lists, tables)
  const lists = document.querySelectorAll('.markdown-description ul');
  lists.forEach((list, index) => {
    list.classList.add('list-group');

    const listItems = list.querySelectorAll('li');
    listItems.forEach((li) => {
      li.classList.add('list-group-item');
    });
  });

  const olists = document.querySelectorAll('.markdown-description ol');
  olists.forEach((list, index) => {
    list.classList.add('list-group', 'list-group-numbered');

    const listItems = list.querySelectorAll('li');
    listItems.forEach((li) => {
      li.classList.add('list-group-item');
    });
  });

  const tables = document.querySelectorAll('.markdown-description table');
  tables.forEach((table, index) => {
    // Add basic boostrap class for tables
    table.classList.add('table', 'table-bordered');

    // Make the table responsive
    const responsiveDiv = document.createElement('div');
    responsiveDiv.classList.add('table-responsive');
    table.parentNode.insertBefore(responsiveDiv, table);
    responsiveDiv.appendChild(table);
  });
}


function findCVEIdentifiers(text) {
  // Regex pattern to match CVE identifiers (e.g., CVE-2021-34527)
  const cveRegex = /\bCVE-\d{4}-\d{4,7}\b/gi;

  // Find all matches
  const matches = text.match(cveRegex);

  // Return the array of matches or an empty array if none are found
  return matches || [];
}


function linkifyCVE(inputString) {
  // Regular expression to match CVE IDs in the format CVE-YYYY-NNNNN
  const cveRegex = /\bCVE-\d{4}-\d{4,7}\b/gi;

  // Replace each match with a link
  return inputString.replace(cveRegex, (cve) => {
      return `<a href="https://vulnerability.circl.lu/vuln/${cve}" target="_blank">${cve}</a>`;
  });
}

function linkifyGHSA(inputString) {
  // Regular expression to match GHSA IDs in the format GHSA-xxxx-xxxx-xxxx
  const ghsaRegex = /\bGHSA(-[23456789cfghjmpqrvwx]{4}){3}\b/gi;

  // Replace each match with a link
  return inputString.replace(ghsaRegex, (ghsa) => {
      return `<a href="https://vulnerability.circl.lu/vuln/${ghsa}" target="_blank">${ghsa}</a>`;
  });
}

function linkifySecurityIdentifiers(inputString) {
  // Regular expressions for CVE, GHSA, and PySec
  const cveRegex = /\bCVE-\d{4}-\d{4,7}\b/gi;
  const ghsaRegex = /\bGHSA(-[23456789cfghjmpqrvwx]{4}){3}\b/gi;
  const pysecRegex = /\bpysec-\d{4}-\d+\b/gi;

  // Split the input string by <a> tags to avoid altering existing links
  return inputString.replace(/(<a[^>]*>.*?<\/a>)|([^<]+)/g, (match, anchor, nonAnchor) => {
      // If it's an anchor tag, return it unchanged
      if (anchor) return anchor;

      // If it's not inside an anchor tag, replace CVE and GHSA IDs
      return nonAnchor
          .replace(cveRegex, (cve) => {
              return `<a href="https://vulnerability.circl.lu/vuln/${cve}">${cve}</a>`;
          })
          .replace(ghsaRegex, (ghsa) => {
              return `<a href="https://vulnerability.circl.lu/vuln/${ghsa}">${ghsa}</a>`;
          })
          .replace(pysecRegex, (pysec) => {
            return `<a href="https://vulnerability.circl.lu/vuln/${pysec}">${pysec}</a>`;
          });
  });
}
