
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://vulnerability.circl.lu/static/schemas/CIRCL/Security_Advisory_Comment.json",
    "type": "object",
    "title": "Security Advisory comment format.",
    "description": "This schema specifies the format of a comment related to a security advisory.",
    "required": [
      "uuid",
      "vulnerability_lookup_origin",
      "creation_timestamp",
      "timestamp",
      "title",
      "description",
      "vulnerability"
    ],
    "additionalProperties": false,
    "properties": {
      "uuid": {
        "type": "string",
        "format": "uuid",
        "description": "UUIDv4 of the comment",
        "readOnly": true,
        "options": {"hidden": true}
      },
      "vulnerability_lookup_origin": {
        "type": "string",
        "pattern": "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
        "description": "UUIDv4 of the vulnerability lookup instance",
        "default": "1a89b78e-f703-45f3-bb86-59eb712668bd",
        "readOnly": true,
        "options": {"hidden": true}
      },
      "creation_timestamp": {
        "type": "string",
        "format": "datetime-local",
        "description": "When the comment was created originally",
        "options": {"hidden": true}
      },
      "timestamp": {
        "type": "string",
        "format": "datetime-local",
        "description": "When the comment was last updated",
        "options": {"hidden": true}
      },
      "title": {
        "type": "string",
        "description": "Title of the comment",
        "title": "Title of the comment",
        "maxLength": 65535
      },
      "description": {
        "type": "string",
        "format": "markdown",
        "description": "Description of the comment",
        "title": "Description of the comment"
      },
      "description_format": {
        "type": "string",
        "enum": ["markdown", "text"],
        "default": "markdown",
        "description": "Format of the description (markdown or text)."
      },
      "vulnerability": {
        "type": "string",
        "description": "The identifier of the vulnerability (CVE ID, GHSA-ID, PYSEC ID, etc.).",
        "options": {"hidden": true}
      },
      "related_vulnerabilities": {
        "type": "array",
        "items": {
          "headerTemplate": "Vulnerability {{i1}}",
          "type": "string",
          "description": "Vulnerability reference (CVE ID, GHSA-ID, PYSEC ID, etc.)."
        },
        "description": "One or more vulnerability references for this comment."
      },
      "meta": {
        "type": "array",
        "items": {
          "headerTemplate": "Object {{i1}}",
          "type": "object",
          "description": "Meta fields"
        },
        "description": "Zero or more meta-fields"
      }
    }
  }
