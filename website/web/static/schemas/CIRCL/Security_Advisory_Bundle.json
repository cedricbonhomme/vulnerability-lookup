
{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://vulnerability.circl.lu/static/schemas/CIRCL/Security_Advisory_Bundle.json",
    "type": "object",
    "title": "Security Advisory bundle format.",
    "description": "This schema specifies the format of a bundle related to several security advisories.",
    "required": [
      "uuid",
      "vulnerability_lookup_origin",
      "creation_timestamp",
      "timestamp",
      "name",
      "description",
      "related_vulnerabilities"
    ],
    "additionalProperties": false,
    "properties": {
      "uuid": {
        "type": "string",
        "format": "uuid",
        "description": "UUIDv4 of the bundle.",
        "readOnly": true,
        "options": {"hidden": true}
      },
      "vulnerability_lookup_origin": {
        "type": "string",
        "pattern": "[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
        "description": "UUIDv4 of the vulnerability lookup instance.",
        "default": "1a89b78e-f703-45f3-bb86-59eb712668bd",
        "readOnly": true,
        "options": {"hidden": true}
      },
      "creation_timestamp": {
        "type": "string",
        "format": "datetime-local",
        "description": "When the bundle was created originally.",
        "options": {"hidden": true}
      },
      "timestamp": {
        "type": "string",
        "format": "datetime-local",
        "description": "When the bundle was last updated.",
        "options": {"hidden": true}
      },
      "name": {
        "type": "string",
        "title": "Name of the bundle.",
        "maxLength": 65535
      },
      "description": {
        "type": "string",
        "format": "markdown",
        "title": "Description of the bundle."
      },
      "description_format": {
        "type": "string",
        "enum": ["markdown", "text"],
        "default": "markdown",
        "description": "Format of the bundle (markdown or text)."
      },
      "related_vulnerabilities": {
        "type": "array",
        "minItems": 1,
        "items": {
          "headerTemplate": "Vulnerability {{i1}}",
          "type": "string",
          "minLength": 1,
          "description": "Vulnerability reference (CVE ID, GHSA-ID, PYSEC ID, etc.)."
        },
        "title": "Related vulnerabilities",
        "description": "One or more vulnerability references for this bundle."
      },
      "meta": {
        "type": "array",
        "items": {
          "headerTemplate": "Object {{i1}}",
          "type": "object",
          "description": "Meta fields"
        },
        "description": "Zero or more meta-fields"
      }
    }
  }
