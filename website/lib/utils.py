from typing import List

import re


def find_cve_ids(text: str) -> List[str]:
    """Find CVE IDs in a text. Returns a list of string."""
    # Regex pattern to match CVE IDs (e.g., CVE-2021-34527 or cve-2021-34527)
    cve_pattern = r"CVE-\d{4}-\d{4,7}"

    # Find all matches in the text (case-insensitive search)
    cve_ids = re.findall(cve_pattern, text, re.IGNORECASE)

    cve_ids = [item.upper() for item in cve_ids]
    cve_ids = list(set(cve_ids))

    return cve_ids


def find_ghsa_ids(text: str) -> List[str]:
    """Find GHSA IDs in a text. Returns a list of string."""
    # Regex pattern to match GHSA IDs (e.g., GHSA-xxxx-xxxx-xxxx or ghsa-xxxx-xxxx-xxxx)
    ghsa_pattern = r"GHSA-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}"

    # Find all matches in the text (case-insensitive search)
    ghsa_ids = re.findall(ghsa_pattern, text, re.IGNORECASE)

    ghsa_ids = [item.lower() for item in ghsa_ids]
    ghsa_ids = [item.replace("ghsa-", "GHSA-") for item in ghsa_ids]
    ghsa_ids = list(set(ghsa_ids))

    return ghsa_ids


def find_pysec_ids(text: str) -> List[str]:
    """Find PyPI Security Advisory (PySec) IDs in a text. Returns a list of string."""
    # Regex pattern to match PySec IDs (e.g., PYSEC-YYYY-NNN or pysec-yyyy-nnn)
    pysec_pattern = r"PYSEC-\d{4}-\d{2,5}"

    # Find all matches in the text (case-insensitive search)
    pysec_ids = re.findall(pysec_pattern, text, re.IGNORECASE)
    pysec_ids = [item.upper() for item in pysec_ids]
    pysec_ids = list(set(pysec_ids))

    return pysec_ids
